"0","set.seed(123)"
"0","n = 20"
"0","A1 = rnbinom(n = n, size = 2, mu = 200)"
"0","A2 = 2 * A1"
"0","a1 = log(A1)"
"0","a2 = log(A2)"
"0","O1 = floor(A1 * 0.25)"
"0","O2 = floor(A2 * 0.25)"
"0","O1[1:7] = 0"
"0","O2[14:20] = 0"
"0",""
"0","df0 = data.frame(tax1 = a1, tax2 = a2)"
"0",""
"0","df1 = data.frame(tax1 = log(O1), tax2 = log(O2)) %>%"
"0","  mutate_if(is.numeric, list(~na_if(., -Inf)))"
"0",""
"0","df2 = data.frame(tax1 = log(O1 + 1), tax2 = log(O2 + 1)) %>%"
"0","  mutate_if(is.numeric, list(~na_if(., -Inf)))"
"0",""
"0","df = df0 %>%"
"0","  mutate(type = ""True abundances"") %>%"
"0","  bind_rows("
"0","    df1 %>%"
"0","      mutate(type = ""CCA"") "
"0","  ) %>%"
"0","  bind_rows("
"0","    df2 %>%"
"0","      mutate(type = ""Add One"")"
"0","  )"
"0","df$type = factor(df$type, c(""True abundances"", ""CCA"", ""Add One""))"
"0",""
"0","ann = data.frame(x = c(4, 3, 1.5), y = c(5.8, 4.4, 4), "
"0","                 label = c(paste0(""r = "", round(cor.test(df0$tax1, df0$tax2, method = ""pearson"")$estimate, 2),"
"0","                                  ""\np = "", round(cor.test(df0$tax1, df0$tax2, method = ""pearson"")$p.value, 2)),"
"0","                           paste0(""r = "", round(cor.test(df1$tax1, df1$tax2, method = ""pearson"")$estimate, 2),"
"0","                                  ""\np = "", round(cor.test(df1$tax1, df1$tax2, method = ""pearson"")$p.value, 2)),"
"0","                           paste0(""r = "", round(cor.test(df2$tax1, df2$tax2, method = ""pearson"")$estimate, 2),"
"0","                                  ""\np = "", round(cor.test(df2$tax1, df2$tax2, method = ""pearson"")$p.value, 2))),"
"0","                 type = c(""True abundances"", ""CCA"", ""Add One""))"
"0","ann$type = factor(ann$type, c(""True abundances"", ""CCA"", ""Add One""))"
"0",""
"0","p_pseudo2 = ggplot(data = df, aes(x = tax1, y = tax2)) +"
"0","  geom_point() +"
"0","  facet_wrap(.~type, scales = ""free"") +"
"0","  geom_smooth(method = ""lm"", se = FALSE, linetype = ""dashed"") +"
"0","  labs(x = ""Taxon 1"", y = ""Taxon 2"", title = ""Correlated Pair"") + "
"0","  geom_label(data = ann, aes(x = x, y = y, label = label),"
"0","             color = ""orange"", size = 4, fontface = ""bold"") +"
"0","  theme_bw() +"
"0","  theme(strip.background = element_rect(fill = ""white""),"
"0","        plot.title = element_text(hjust = 0.5))"
