"0","get_upper_tri = function(cormat){"
"0","    cormat[lower.tri(cormat)] = NA"
"0","    diag(cormat) = NA"
"0","    return(cormat)"
"0","}"
"0",""
"0","vlr = function(mat, x) {"
"0","  lr = log(mat/x)"
"0","  vlr = apply(lr, 2, var)"
"0","  return(vlr)"
"0","}"
"0",""
"0","hard_thresh = function(R, th){"
"0","  R_th = R"
"0","  R_th[abs(R) <= th] = 0"
"0","  return(R_th)"
"0","}"
"0",""
"0","p_filter = function(mat, mat_p, max_p){"
"0","  ind_p = mat_p"
"0","  ind_p[mat_p > max_p] = 0"
"0","  ind_p[mat_p <= max_p] = 1"
"0","  "
"0","  mat_filter = mat * ind_p"
"0","  return(mat_filter)"
"0","}"
