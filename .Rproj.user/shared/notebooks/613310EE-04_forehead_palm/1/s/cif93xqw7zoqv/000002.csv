"0","# Metadata"
"0","forehead_meta = read_tsv(""../data/body_sites/forehead_meta.txt"")"
"1","[1m[1mRows: [1m[22m[34m[34m939[34m[39m [1m[1mColumns: [1m[22m[34m[34m138[34m[39m
"
"1","[36m--[39m [1m[1mColumn specification[1m[22m [36m---------------------------------------------------------------------------------------[39m
[1mDelimiter:[22m ""\t""
[31mchr[39m (77): sample_name, age_unit, anonymized_name, antibiotics, artificialtanning, bmiclass, body_habitat, b...
[32mdbl[39m (17): age, bmi, elevation, host_taxid, latitude, longitude, observedotus, pd, qiita_study_id, sequencec...
[33mlgl[39m (44): ambiguoustimepoint, antibiotic_disturbance, anytimeseries, appendix, asthma, beestingallergies, b...
"
"1","
[36mi[39m Use [38;5;235m[48;5;253m[38;5;235m[48;5;253m`spec()`[48;5;253m[38;5;235m[49m[39m to retrieve the full column specification for this data.
[36mi[39m Specify the column types or set [38;5;235m[48;5;253m[38;5;235m[48;5;253m`show_col_types = FALSE`[48;5;253m[38;5;235m[49m[39m to quiet this message.
"
"0","forehead_meta = forehead_meta %>%"
"0","  select(sample_name, control, weeknumber, bodysite, age, gender, bmi, "
"0","         raceethnicity, antibiotic_disturbance, country, diet, university) %>%"
"0","  filter(control == FALSE,"
"0","         antibiotic_disturbance == FALSE,"
"0","         weeknumber == 1) %>%"
"0","  arrange(control, weeknumber, bodysite, age, gender, bmi, "
"0","          raceethnicity, antibiotic_disturbance, country, diet, university)"
"0",""
"0","palm_meta = palm_meta %>%"
"0","  arrange(control, weeknumber, bodysite, age, gender, bmi, "
"0","          raceethnicity, antibiotic_disturbance, country, diet, university)"
"0",""
"0","forehead_meta = forehead_meta %>%"
"0","  mutate(host_subject_id = palm_meta$host_subject_id) %>%"
"0","  select(sample_name, host_subject_id, everything())"
"0",""
"0","sample_name = forehead_meta$sample_name"
"0","subj_name = forehead_meta$host_subject_id"
"0","  "
"0","# OTU table"
"0","biom_forehead = read_biom(""../data/body_sites/forehead_otu.biom"")"
"0","forehead_otu = as(biom_data(biom_forehead), ""matrix"")"
"0","col_ind = match(sample_name, colnames(forehead_otu))"
"0","forehead_otu = forehead_otu[, col_ind[!is.na(col_ind)]]"
"0","colnames(forehead_otu) = subj_name[which(!is.na(col_ind))]"
"0",""
"0","# Taxonomy"
"0","forehead_tax = read_tsv(""../data/body_sites/forehead_taxonomy.tsv"")"
"1","[1m[1mRows: [1m[22m[34m[34m50799[34m[39m [1m[1mColumns: [1m[22m[34m[34m3[34m[39m
"
"1","[36m--[39m [1m[1mColumn specification[1m[22m [36m---------------------------------------------------------------------------------------[39m
[1mDelimiter:[22m ""\t""
[31mchr[39m (2): Feature ID, Taxon
[32mdbl[39m (1): Confidence
"
"1","
[36mi[39m Use [38;5;235m[48;5;253m[38;5;235m[48;5;253m`spec()`[48;5;253m[38;5;235m[49m[39m to retrieve the full column specification for this data.
[36mi[39m Specify the column types or set [38;5;235m[48;5;253m[38;5;235m[48;5;253m`show_col_types = FALSE`[48;5;253m[38;5;235m[49m[39m to quiet this message.
"
"0","otu_id = forehead_tax$`Feature ID`"
"0","forehead_tax = data.frame(forehead_tax[, - c(1, 3)], row.names = otu_id)"
"0","forehead_tax = forehead_tax %>% "
"0","  separate(col = Taxon, "
"0","           into = c(""Kingdom"", ""Phylum"", ""Class"", ""Order"", "
"0","                    ""Family"", ""Genus"", ""Species""),"
"0","           sep = "";"") %>%"
"0","  rowwise() %>%"
"0","  dplyr::mutate_all(function(x) strsplit(x, ""__"")[[1]][2]) %>%"
"0","  dplyr::mutate_all(function(x) gsub(""\\[|\\]"", """", x)) %>%"
"0","  mutate(Species = ifelse(!is.na(Species) & !is.na(Genus),"
"0","                          paste(strsplit(Genus, """")[[1]][1], Species, sep = "".""),"
"0","                          NA)) %>%"
"0","  ungroup()"
"2","Warning:"
"2"," Expected 7 pieces. Missing pieces filled with `NA` in 15711 rows [1, 3, 4, 5, 6, 10, 12, 16, 18, 21, 22, 23, 25, 26, 27, 30, 31, 37, 38, 39, ...].
"
"0","forehead_tax = as.matrix(forehead_tax)"
"0","rownames(forehead_tax) = otu_id"
"0","forehead_tax[forehead_tax == """"] = NA"
"0",""
"0","# OTU data"
"0","FOREHEAD_OTU = otu_table(forehead_otu, taxa_are_rows = TRUE)"
"0","FOREHEAD_META = sample_data(forehead_meta)"
"0","sample_names(FOREHEAD_META) = forehead_meta$host_subject_id"
"0","FOREHEAD_TAX = tax_table(forehead_tax)"
"0","forehead_otu_data = phyloseq(FOREHEAD_OTU, FOREHEAD_TAX, FOREHEAD_META)"
