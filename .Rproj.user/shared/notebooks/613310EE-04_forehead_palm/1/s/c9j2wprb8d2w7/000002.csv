"0","pseqs = list(forehead = c(forehead_otu_data, forehead_genus_data2),"
"0","             palm = c(palm_otu_data, palm_genus_data2))"
"0","pseudo = 0; zero_cut = 0.5; corr_cut = 0.5; lib_cut = 1000"
"0","wins_quant = c(0, 1); method = ""pearson""; soft = FALSE; thresh_len = 20"
"0","n_cv = 10; seed = 123; thresh_hard = 0.3; max_p_linear = 0.001; n_cl = 5"
"0",""
"0","res_linear = secom_linear(pseqs, pseudo, zero_cut, corr_cut, lib_cut, "
"0","                          wins_quant, method, soft, thresh_len, n_cv, "
"0","                          seed, thresh_hard, max_p_linear, n_cl)"
"2","The number of samples that are common across datasets: 89
"
"0","R = 1000; seed = 123; max_p_dist = 0.001"
"0","res_dist = secom_dist(pseqs, pseudo, zero_cut, corr_cut, lib_cut, "
"0","                      wins_quant, R, seed, max_p_dist, n_cl)"
"2","The number of samples that are common across datasets: 89
"
"0","# Data organization"
"0","# Linear relationships"
"0","# corr_linear = res_linear$corr_th"
"0","corr_linear = res_linear$corr_fl"
"0","cooccur_linear = res_linear$mat_cooccur"
"0",""
"0","# Filter by co-occurrence"
"0","overlap = 10"
"0","corr_linear[cooccur_linear < overlap] = 0"
"0",""
"0","df_linear = data.frame(get_upper_tri(corr_linear)) %>%"
"0","  rownames_to_column(""var1"") %>%"
"0","  pivot_longer(cols = -var1, names_to = ""var2"", values_to = ""value"") %>%"
"0","  filter(!is.na(value)) %>%"
"0","  mutate(var2 = gsub(""\\..."", "" - "", var2),"
"0","         value = round(value, 2),"
"0","         metric = ""Pearson"")"
"0",""
"0","# Distance relationships"
"0","corr_dist = res_dist$dcorr_fl"
"0","cooccur_dist = res_dist$mat_cooccur"
"0",""
"0","# Filter by co-occurrence"
"0","overlap = 10"
"0","corr_dist[cooccur_dist < overlap] = 0"
"0",""
"0","df_dist = data.frame(get_upper_tri(corr_dist)) %>%"
"0","  rownames_to_column(""var1"") %>%"
"0","  pivot_longer(cols = -var1, names_to = ""var2"", values_to = ""value"") %>%"
"0","  filter(!is.na(value)) %>%"
"0","  mutate(var2 = gsub(""\\..."", "" - "", var2),"
"0","         value = round(value, 2),"
"0","         metric = ""Distance"")"
"0",""
"0","# Merge datasets"
"0","df_secom = df_linear %>%"
"0","  bind_rows("
"0","    df_dist"
"0","  )"
"0","genus_level = sort(union(df_secom$var1, df_secom$var2))"
"0","genus_label = sapply(genus_level, function(x) strsplit(x, "" - "")[[1]][2])"
"0","txt_color = ifelse(grepl(""forehead"", genus_level), ""#1B9E77"", ""#D95F02"")"
"0","df_secom$var1 = factor(df_secom$var1, levels = genus_level)"
"0","df_secom$var2 = factor(df_secom$var2, levels = genus_level)"
"0","df_secom$metric = factor(df_secom$metric, levels = c(""Pearson"", ""Distance""))"
"0",""
"0","heat_secom = df_secom %>%"
"0","  ggplot(aes(var2, var1, fill = value)) +"
"0","  geom_tile(color = ""black"") +"
"0","  scale_fill_gradient2(low = ""blue"", high = ""red"", mid = ""white"", na.value = ""grey"","
"0","                       midpoint = 0, limit = c(-1,1), space = ""Lab"", "
"0","                       name = NULL) +"
"0","  scale_x_discrete(drop = FALSE, labels = genus_label) +"
"0","  scale_y_discrete(drop = FALSE, labels = genus_label) +"
"0","  facet_grid(.~metric) +"
"0","  geom_text(aes(var2, var1, label = value), color = ""black"", size = 4) +"
"0","  labs(x = NULL, y = NULL, title = ""Forehead and Palm"") +"
"0","  guides(fill = guide_colorbar(barwidth = 1, barheight = 7, "
"0","                               title.position = ""right"")) +"
"0","  theme_bw() +"
"0","  theme(axis.text.x = element_text(angle = 45, vjust = 1, size = 12, hjust = 1, "
"0","                                   face = ""italic"", color = txt_color),"
"0","        axis.text.y = element_text(size = 12, face = ""italic"", color = txt_color),"
"0","        strip.text.x = element_text(size = 14),"
"0","        strip.text.y = element_text(size = 14),"
"0","        legend.text = element_text(size = 12),"
"0","        plot.title = element_text(hjust = 0.5, size = 15),"
"0","        panel.grid.major = element_blank(),"
"0","        axis.ticks = element_blank()) +"
"0","  coord_fixed()"
