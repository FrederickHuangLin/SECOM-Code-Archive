"0","palm_subj = sample_names(palm_otu_data)"
"0","forehead_subj = sample_names(forehead_otu_data)"
"0","common_subj = intersect(palm_subj, forehead_subj)"
"0",""
"0","palm_otu_data = subset_samples(palm_otu_data, host_subject_id %in% common_subj)"
"0","forehead_otu_data = subset_samples(forehead_otu_data, host_subject_id %in% common_subj)"
"0",""
"0","# Taxonomy cleaning"
"0","# Palm"
"0","ind1 = data.frame(palm_tax) %>%"
"0","  rownames_to_column(""otu_id"") %>%"
"0","  filter(grepl(""Clostridium"", Genus)) %>%"
"0","  .$otu_id"
"0",""
"0","ind2 = data.frame(palm_tax) %>%"
"0","  rownames_to_column(""otu_id"") %>%"
"0","  filter(grepl(""Ruminococcus"", Genus)) %>%"
"0","  .$otu_id"
"0",""
"0","ind3 = data.frame(palm_tax) %>%"
"0","  rownames_to_column(""otu_id"") %>%"
"0","  filter(grepl(""Prevotella"", Genus)) %>%"
"0","  .$otu_id"
"0",""
"0","ind4 = data.frame(palm_tax) %>%"
"0","  rownames_to_column(""otu_id"") %>%"
"0","  filter(grepl(""Bacteroides"", Genus)) %>%"
"0","  .$otu_id"
"0",""
"0","palm_otu_data2 = merge_taxa(palm_otu_data, "
"0","                           taxa_names(palm_otu_data)[taxa_names(palm_otu_data) %in% ind1], "
"0","                           1)"
"0","palm_otu_data2 = merge_taxa(palm_otu_data2, "
"0","                           taxa_names(palm_otu_data2)[taxa_names(palm_otu_data2) %in% ind2], "
"0","                           1)"
"0","palm_otu_data2 = merge_taxa(palm_otu_data2, "
"0","                           taxa_names(palm_otu_data2)[taxa_names(palm_otu_data2) %in% ind3], "
"0","                           1)"
"0","palm_otu_data2 = merge_taxa(palm_otu_data2, "
"0","                           taxa_names(palm_otu_data2)[taxa_names(palm_otu_data2) %in% ind4], "
"0","                           1)"
"0","palm_otu_data2 = phyloseq(otu_table(abundances(palm_otu_data2), taxa_are_rows = TRUE), "
"0","                          PALM_TAX, PALM_META)"
"0",""
"0","# forehead"
"0","ind1 = data.frame(forehead_tax) %>%"
"0","  rownames_to_column(""otu_id"") %>%"
"0","  filter(grepl(""Clostridium"", Genus)) %>%"
"0","  .$otu_id"
"0",""
"0","ind2 = data.frame(forehead_tax) %>%"
"0","  rownames_to_column(""otu_id"") %>%"
"0","  filter(grepl(""Ruminococcus"", Genus)) %>%"
"0","  .$otu_id"
"0",""
"0","ind3 = data.frame(forehead_tax) %>%"
"0","  rownames_to_column(""otu_id"") %>%"
"0","  filter(grepl(""Prevotella"", Genus)) %>%"
"0","  .$otu_id"
"0",""
"0","ind4 = data.frame(forehead_tax) %>%"
"0","  rownames_to_column(""otu_id"") %>%"
"0","  filter(grepl(""Pseudomonas"", Genus)) %>%"
"0","  .$otu_id"
"0",""
"0","forehead_otu_data2 = merge_taxa(forehead_otu_data, "
"0","                              taxa_names(forehead_otu_data)[taxa_names(forehead_otu_data) %in% ind1], "
"0","                              1)"
"0","forehead_otu_data2 = merge_taxa(forehead_otu_data2, "
"0","                              taxa_names(forehead_otu_data2)[taxa_names(forehead_otu_data2) %in% ind2], "
"0","                              1)"
"0","forehead_otu_data2 = merge_taxa(forehead_otu_data2, "
"0","                              taxa_names(forehead_otu_data2)[taxa_names(forehead_otu_data2) %in% ind3],"
"0","                              1)"
"0","forehead_otu_data2 = merge_taxa(forehead_otu_data2, "
"0","                              taxa_names(forehead_otu_data2)[taxa_names(forehead_otu_data2) %in% ind4], "
"0","                              1)"
"0","forehead_otu_data2 = phyloseq(otu_table(abundances(forehead_otu_data2), taxa_are_rows = TRUE), "
"0","                            FOREHEAD_TAX, FOREHEAD_META)"
"0",""
"0","palm_otu_data2 = subset_samples(palm_otu_data2, host_subject_id %in% common_subj)"
"0","forehead_otu_data2 = subset_samples(forehead_otu_data2, host_subject_id %in% common_subj)"
"0",""
"0","# Aggregate to genus level"
"0","palm_genus_data = aggregate_taxa(palm_otu_data2, ""Genus"")"
"0","palm_genus_data = subset_taxa(palm_genus_data, Genus != ""Unknown"")"
"0","forehead_genus_data = aggregate_taxa(forehead_otu_data2, ""Genus"")"
"0","forehead_genus_data = subset_taxa(forehead_genus_data, Genus != ""Unknown"")"
"0",""
"0","# Discard rare taxa"
"0","palm_core_genus = core_members(microbiome::transform(palm_genus_data, ""compositional""), detection = 0, prevalence = 0.5)"
"0","forehead_core_genus = core_members(microbiome::transform(forehead_genus_data, ""compositional""), detection = 0, prevalence = 0.5)"
"0","palm_genus_data1 = subset_taxa(palm_genus_data, Genus %in% palm_core_genus)"
"0","forehead_genus_data1 = subset_taxa(forehead_genus_data, Genus %in% forehead_core_genus)"
"0",""
"0","# Select top taxa for visualization"
"0","palm_top_genus = top_taxa(palm_genus_data1, n = 10)"
"0","forehead_top_genus = top_taxa(forehead_genus_data1, n = 10)"
"0","top_genus = intersect(forehead_top_genus, palm_top_genus)[1:5]"
"0","palm_genus_data2 = subset_taxa(palm_genus_data, Genus %in% top_genus)"
"0","forehead_genus_data2 = subset_taxa(forehead_genus_data, Genus %in% top_genus)"
