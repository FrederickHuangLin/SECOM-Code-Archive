"0","set.seed(1)"
"0","n = 50"
"0","d = 100"
"0","mu = c(rep(NA, 4), # Taxa with correlations"
"0","       10000, 10000, # High abundant taxa"
"0","       sample(c(200, 50), d - 6, replace = TRUE, prob = c(0.8, 0.2))) # Low abundant taxa"
"0","# NB distribution"
"0","dispersion = 0.5"
"0",""
"0","# Absolute abundances"
"0","A = matrix(NA, ncol = n, nrow = d)"
"0","for (i in seq.int(from = 5, to = d)) {"
"0","  A[i, ] = rnbinom(n = n, size = 1/dispersion, mu = mu[i])"
"0","}"
"0",""
"0","# Dependent pairs of taxa"
"0","template1 = rnbinom(n = n, size = 1/dispersion, mu = 2000)"
"0","template2 = rnbinom(n = n, size = 1/dispersion, mu = 2000)"
"0","template1_poly = poly(x = template1, degree = 1, raw = FALSE)"
"0","template2_poly = poly(x = template2, degree = 2, raw = FALSE)"
"0","poly1 = round(10000 * template1_poly[, 1] + 10000)"
"0","poly2 = round(10000 * template2_poly[, 2] + 10000)"
"0","A_dep = rbind(template1, template2, poly1, poly2)"
"0",""
"0","for (i in 1:4) {"
"0","  A[i, ] = A_dep[i, ]"
"0","}"
"0","mu[1:2] = 2000"
"0","mu[3:4] = 10000"
"0",""
"0","taxa_id = paste0(""T"", seq_len(d))"
"0","sample_id = paste0(""S"", seq_len(n))"
"0","rownames(A) = taxa_id"
"0","colnames(A) = sample_id"
"0",""
"0","p_A = data.frame(t(A[1:5, ])) %>% "
"0","  ggpairs(title = ""Synthetic Absolute Abundances"","
"0","          progress = FALSE,"
"0","          upper = NULL, diag = NULL) +"
"0","  theme_bw() + "
"0","  theme(plot.title = element_text(hjust = 0.5),"
"0","        strip.background = element_rect(fill = ""white""))"
"0","print(p_A)"
