"0","# Sequencing efficiency"
"0","C = rbeta(n = d, shape1 = 5, shape2 = 5)"
"0",""
"0","# Microbial loads in the ecosystem"
"0","A_prim = A * C"
"0","A_dot = colSums(A_prim)"
"0",""
"0","# Relative abundances in the ecosystem"
"0","R = A_prim/t(replicate(d, A_dot))"
"0",""
"0","# Sampling fractions"
"0","S = rbeta(n = n, shape1 = 2, shape2 = 10)"
"0",""
"0","# Library sizes"
"0","O_dot = round(S * A_dot)"
"0","# Observed abundances"
"0","O = matrix(NA, nrow = d, ncol = n)"
"0","for (i in seq(n)) {"
"0","  O[, i] = rmultinom(1, size = O_dot[i], prob = R[, i])"
"0","}"
"0","rownames(O) = taxa_id"
"0","colnames(O) = sample_id"
"0",""
"0","# Random errors"
"0","E = O/(A * C * t(replicate(d, S)))"
"0",""
"0","# Log scale parameters"
"0","a = log(A)"
"0","c = log(C)"
"0","s = log(S)"
"0","e = log(E)"
"0","# Log scale variables"
"0","o = log(O)"
"0","r = O/t(replicate(d, O_dot))"
"0",""
"0","p_o = data.frame(t(log(O[1:5, ]))) %>% "
"0","  ggpairs(title = ""Synthetic Log Observed Abundances"","
"0","          progress = FALSE, upper = NULL, diag = NULL) +"
"0","  theme_bw() + "
"0","  theme(plot.title = element_text(hjust = 0.5),"
"0","        strip.background = element_rect(fill = ""white""))"
"0","print(p_o)"
