"0","cor2cov = function(R, std) {"
"0","  Sigma = outer(std, std) * R"
"0","  return(Sigma)"
"0","}"
"0",""
"0","get_upper_tri = function(cormat){"
"0","    cormat[lower.tri(cormat)] = NA"
"0","    diag(cormat) = NA"
"0","    return(cormat)"
"0","}"
"0",""
"0","p_dens = function(p_mat) {"
"0","  p_vec = p_mat[upper.tri(p_mat)]"
"0","  "
"0","  df_line = data.frame(xintercept = c(0.01, 0.05), "
"0","                       Lines = c(""p = 0.01"", ""p = 0.05""),"
"0","                       stringsAsFactors = FALSE)"
"0","  "
"0","  fig_p = data.frame(p = p_vec) %>%"
"0","    ggplot(aes(x = p)) +"
"0","    stat_ecdf(geom = ""point"") +"
"0","    geom_vline(aes(xintercept = xintercept, color = Lines), df_line, "
"0","               linetype = ""dashed"", size = 1) +"
"0","    labs(x = ""P-value"", y = ""Cumulative density"") +"
"0","    scale_color_discrete(name = NULL) +"
"0","    theme_bw()"
"0","  return(fig_p)"
"0","}"
"0",""
"0","p_filter = function(mat, mat_p, max_p){"
"0","  ind_p = mat_p"
"0","  ind_p[mat_p > max_p] = 0"
"0","  ind_p[mat_p <= max_p] = 1"
"0","  "
"0","  mat_filter = mat * ind_p"
"0","  return(mat_filter)"
"0","}"
"0",""
"0","hard_thresh = function(R, th){"
"0","  R_th = R"
"0","  R_th[abs(R) <= th] = 0"
"0","  return(R_th)"
"0","}"
