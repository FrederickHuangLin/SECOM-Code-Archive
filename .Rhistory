labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
p_impute2
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
scale_x_discrete(breaks = seq(0, 1, 0.2), limits = c(0, 1)) +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
p_impute2
?scale_x_discrete
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
scale_x_discrete(limits = c(0, 1)) +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
p_impute2
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
scale_y_discrete(limits = c(0, 1)) +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
p_impute2
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
scale_y_discrete(limits = c(0, 1), breaks = seq(0, 1, 0.2)) +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
p_impute2
seq(0, 1, 0.2)
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = setting), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_nejm(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
scale_y_discrete(breaks = seq(0, 1, 0.2)) +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
p_impute2
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = setting), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_nejm(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
# scale_y_discrete(breaks = seq(0, 1, 0.2)) +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
p_impute2
res2 = read_csv("../outputs/others/cca_vs_impute_corr.csv")
res2$S = factor(res2$S, levels = c("0.1", "0.05", "0.02", "0.01", "0.005"))
df_fig2 = res2 %>%
pivot_longer(cols = r_cca:r_gbm, names_to = "measure", values_to = "value") %>%
mutate(
type = case_when(
measure == "r_cca" ~ "CCA",
measure == "r_mice" ~ "MICE",
TRUE ~ "GBM"
)
)
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
# scale_y_discrete(breaks = seq(0, 1, 0.2)) +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
p_impute2
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = setting), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_nejm(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
scale_y_discrete(breaks = seq(0, 1, 0.2)) +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
res2 = read_csv("../outputs/others/cca_vs_impute_corr.csv")
res2$S = factor(res2$S, levels = c("0.1", "0.05", "0.02", "0.01", "0.005"))
df_fig2 = res2 %>%
pivot_longer(cols = r_cca:r_gbm, names_to = "measure", values_to = "value") %>%
mutate(
type = case_when(
measure == "r_cca" ~ "CCA",
measure == "r_mice" ~ "MICE",
TRUE ~ "GBM"
)
)
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = setting), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_nejm(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
scale_y_discrete(breaks = seq(0, 1, 0.2)) +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = setting), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_nejm(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
scale_y_discrete(breaks = seq(0, 1, 0.2)) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = setting), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_nejm(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
# scale_y_discrete(breaks = seq(0, 1, 0.2)) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
rlang::last_error()
res2 = read_csv("../outputs/others/cca_vs_impute_corr.csv")
res2$S = factor(res2$S, levels = c("0.1", "0.05", "0.02", "0.01", "0.005"))
df_fig2 = res2 %>%
pivot_longer(cols = r_cca:r_gbm, names_to = "measure", values_to = "value") %>%
mutate(
type = case_when(
measure == "r_cca" ~ "CCA",
measure == "r_mice" ~ "MICE",
TRUE ~ "GBM"
)
)
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = setting), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_nejm(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
# guides(fill = guide_legend(override.aes = list(shape = NA))) +
scale_y_discrete(breaks = seq(0, 1, 0.2)) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
p_impute2
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9))
p_impute2
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL)
p_impute2
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
# guides(fill = guide_legend(override.aes = list(shape = NA))) +
scale_y_discrete(breaks = seq(0, 1, 0.2))
p_impute2
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
# guides(fill = guide_legend(override.aes = list(shape = NA))) +
scale_y_discrete(breaks = seq(0, 1, 0.2)) +
geom_hline(yintercept = 0.8, linetype = "dashed")
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
# guides(fill = guide_legend(override.aes = list(shape = NA))) +
scale_y_discrete(breaks = seq(0, 1, 0.2)) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients")
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = setting), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_nejm(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
# guides(fill = guide_legend(override.aes = list(shape = NA))) +
scale_y_discrete(breaks = seq(0, 1, 0.2)) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
# guides(fill = guide_legend(override.aes = list(shape = NA))) +
scale_y_discrete(breaks = seq(0, 1, 0.2)) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients")
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
# guides(fill = guide_legend(override.aes = list(shape = NA))) +
scale_y_discrete(breaks = seq(0, 1, 0.2)) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw()
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
# guides(fill = guide_legend(override.aes = list(shape = NA))) +
scale_y_discrete(breaks = seq(0, 1, 0.2)) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = setting), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_nejm(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
# guides(fill = guide_legend(override.aes = list(shape = NA))) +
scale_y_discrete(breaks = seq(0, 1, 0.2)) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = setting), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_nejm(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
# guides(fill = guide_legend(override.aes = list(shape = NA))) +
scale_y_discrete(breaks = seq(0, 1, 0.2)) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
# guides(fill = guide_legend(override.aes = list(shape = NA))) +
scale_y_discrete(breaks = seq(0, 1, 0.2)) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
p_impute2
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
scale_y_discrete(limits = c(0, 1), breaks = seq(0, 1, 0.2)) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
p_impute2
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.2)) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
p_impute2
p_impute2 = df_fig2 %>%
ggplot(aes(x = S, y = value, fill = type)) +
stat_summary(fun = mean, geom = "bar", position = "dodge", color = "black") +
stat_summary(fun.data = mean_sdl, fun.args = list(mult = 1), color = "black",
geom = "errorbar", width = .3, position = position_dodge(.9)) +
geom_point(aes(x = S), size = .1, alpha = .3,
position = position_jitterdodge(jitter.width = .2, dodge.width = .9)) +
scale_fill_npg(name = NULL) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
scale_y_continuous(limits = c(0, 1), breaks = seq(0, 0.9, 0.2)) +
geom_hline(yintercept = 0.8, linetype = "dashed") +
labs(x = "Sampling fraction", y = "Correlation estimate",
title = "Bias of Estimating Zero Correlation Coefficients") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5))
p_impute2
